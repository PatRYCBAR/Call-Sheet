<!DOCTYPE html>
<html>
<head>
<style>
input{
  padding: 5px;
}

.slim{
  padding: 3px;
}

.collapsible {
  background-color: #f1f1f1;
  cursor: pointer;
  border: none;
  text-align: Right;
  outline: none;
}

.collapsible:hover, .collapsible:focus {
  background-color: #d1d1d1;
}

.active {
  background-color: #d1d1f9;
}

.content {
  display: none;
  overflow: hidden;
  background-color: #ededff;
  border-color: #c1c1f9;
  border-left-style: solid;
}

div {
  margin-bottom: 0px;
}

.nothing {
  height: 0px;
  font-size: 0px;
}

</style>
</head>
<body>

<!--
/***********************
* FORM - Top row buttons
************************/
-->

<button onclick="moveToNextCall()"> _‚è≠ üìû_ </button>
  <button onclick="extraTicket()">‚ûïüé´(-)</button>
  <button onclick="copyTicket()">‚ûïüé´(üìÑ)</button><br>

<!--
/******************
* FORM - Basic info
*******************/
-->

<label for="Ticket">Ticket:</label>
  <input type="text" id="Ticket" name="Ticket" size="40"><br>
<label for="UserID">User ID:</label>
  <input type="text" id="UserID" name="UserID"><button tabindex="1" onclick="ToCAPS()">ABC </button> <button tabindex="1" onclick="ToLower()">abc</button><button type="button" class="collapsible" style="width: 100px;" id="phonebutton">More Details</button>
<div class="content" id="phonearea">
  <label for="FullName">Name:</label>
  <input type="text" id="FullName" name="FullName"><br>
  <label for="phone">Phone:</label><br>
  <textarea id="phone" name="phone" rows="2" cols="30"></textarea>
</div><p class="nothing"></p>
<label for="App">App:</label>
  <input type="text" id="App" name="App">
  <input tabindex="1" type="text" id="KBID" name="KBID">
  <button tabindex="1" 	onclick="KBCIURL()">üîçCI</button><br>

<!--
/************************
* FORM - Call Description
*************************/
-->

<p></p>
<label for="this_call">Call Notes for </label> <select name="TicketType" id= "TicketType">
  <option value="___ > ">___ > </option>
  <option value="issue > ">issue > </option>
  <option value="question > ">question > </option>
  <option value="task > ">task > </option>
</select>
<button tabindex="1" type="button" class="collapsible" style="width: 250px;" onclick="" id="more_notes_button">More Notes</button>
<div class="content" id="more_notes">
  <label for="temp_info">Temp:</label>
    <input type="text" id="temp_info" name="temp_info"><br>
  <label for="next_ticket_notes">Next Ticket's Notes:</label><br>
    <textarea id="next_ticket_notes" name="next_ticket_notes" rows="3" cols="60"></textarea><br>
  This Ticket's Notes:
</div><p class="nothing"></p>
<textarea id="this_call" name="this_call" rows="10" cols="60"></textarea><br>

<!--
/************************
* FORM - Location info
*************************/
-->

<input tabindex="1" list="RemoteOrNots" name="RemoteOrNot" id="RemoteOrNot" size="7">
<datalist id="RemoteOrNots">
  <option value="Onsite">
  <option value="Remote">
</datalist>
<input tabindex="1" list="facilities" name="facility" id="facility" size="13">
<input tabindex="1" type="text" id="LocationDetails" name="LocationDetails" size="25">
<br>

<!--
/************************
* FORM - Dynamic Form
*************************/
-->

<label for="steps">Troubleshooting(<input tabindex="1" class="slim" list="macros_02" name="macro_02" id="macro_02" size="7" >):<button tabindex="1" onclick="AddQuickTemplate()">Quick Template</button></label><button tabindex="1" type="button" class="collapsible" style="width: 150px;" id="macro_02_button">More Questions</button>
<div class="content" id="macro_02_questions">
  <p>failed to load</p>
</div><p class="nothing"></p>

<!--
/*****************************
* FORM - Troubleshooting Space
******************************/
-->

<textarea id="steps" name="steps" rows="8" cols="60"></textarea><br>

<!--
/************************
* FORM - PC info
*************************/
-->

<label for="PCinfo">PC:</label>
<textarea id="PCinfo" name="PCinfo" rows="2" cols="30"></textarea><button onclick="CleanBomgar()">Bomgar</button><button onclick="PCUnableToObtain()">Unknown</button><br>

<!--
/************************
* FORM - Print-out area
*************************/
-->

<label for="ProcText">For Proc:</label>
<button onclick="CompressCall()">Ticket</button><button onclick="FollowupCall()">Call</button><button onclick="EpicCall()">Epic</button><br>
<textarea id="ProcText" name="ProcText" rows="3" cols="60"></textarea><br>

<!--
/************************
* FORM - Escalation
*************************/
-->

<label for="Escalations">Escalation?</label>
<select name="Escalations" id= "Escalations">
  <option value="___">___</option>
  <option value="Standard">Standard</option>
  <option value="Epic">Epic</option>
  <option value="PeopleSoft">PeopleSoft</option>
  <option value="Possible Outage">Possible Outage</option>
</select>
<span style="background-color: #f3f3f3;"><input type="checkbox" id="APCEsc" name="APCEsc"><label for="APCEsc">Affecting Patient Care?</label><span>
<button onclick="makeEscSubjLine()">Generate</button>
<br>

<!--
/********************************
* FORM - Macro for Repeated Calls
*********************************/
-->

<button onclick="ApplyMacro01()">Apply</button><button type="button" class="collapsible" style="width: 400px;">Macro</button>
<div class="content">
  <label for="macro_01_this_call">Call Notes </label><br>
  <textarea id="macro_01_this_call" name="macro_01_this_call" rows="10" cols="60"></textarea><br>

  <label for="macro_01_steps">Troubleshooting:</label><br>
  <textarea id="macro_01_steps" name="macro_01_steps" rows="8" cols="60"></textarea><br>
</div>

<!--
/************************
* FORM - Call Logs
*************************/
-->

<p>---</p>


<p><label for="call_log">Call Logs</label></p>
<textarea id="call_log" name="call_log" rows="40" cols="60"></textarea><br>




<script>

/************************
* SCRIPTING
*************************/


/***************************
* SCRIPTING - INITIALIZATION
****************************/

window.addEventListener('beforeunload', (event) => {
  event.returnValue = `Are you sure you want to leave?`;
});

var coll = document.getElementsByClassName("collapsible");
var i;

for (i = 0; i < coll.length; i++) {
  coll[i].addEventListener("click", function() {
    this.classList.toggle("active");
    var content = this.nextElementSibling;
    if (content.style.display === "block") {
      content.style.display = "none";
    } else {
      content.style.display = "block";
    }
    content.firstElementChild.focus();
  });
}



/***************************
* SCRIPTING - METHODS
****************************/


/***************************
* METHODS - On Button Press
****************************/


/***************************
* On Button Press (top row)
****************************/

function moveToNextCall() {
  logCall();
  ClearFields();
}

function extraTicket() {
  let savedData = holdInMap([
    "UserID",
    "FullName",
    "phone",
    "temp_info",
    "next_ticket_notes",
    "PCinfo",
    "RemoteOrNot",
    "facility",
    "LocationDetails"
  ]);
  
  moveToNextCall();
  Uncollapse("phonebutton", "phonearea");
  if(savedData.get("temp_info") != "") Uncollapse("more_notes_button", "more_notes");
  
  savedData.set("this_call",savedData.get("next_ticket_notes"));
  savedData.set("next_ticket_notes","");
  
  loadHeldValues(savedData);
}

function copyTicket() {
  Uncollapse("phonebutton", "phonearea");
  logCall();
  ObjCalled("Ticket").value = "";
}


/*****************************
* On Button Press (basic info)
******************************/

function ToCAPS() {
  ObjCalled("UserID").value = ValueCalled("UserID").toUpperCase();
  ObjCalled("UserID").focus();
}

function ToLower() {
  ObjCalled("UserID").value = ValueCalled("UserID").toLowerCase();
  ObjCalled("UserID").focus();
}

function KBCIURL() {
  let KBID = ValueCalled("KBID");
  let KBCIsite = "http://esdwiki.nychhc.org/index.php?title=Special:Search&search=" + KBID + "#ServiceNow_CI";
  window.open(KBCIsite);
}

/***********************************
* On Button Press (Troubleshooting)
************************************/

function AddQuickTemplate() {
  let oldStep = "";
  let templateLabel = ValueCalled("macro_02");
  let selectedTemplate = "";
  
  selectedTemplate = quickTemplates.get(templateLabel);
  
  oldStep = ValueCalled("steps");
  
  if(oldStep != "")oldStep = oldStep.concat("\n");
  ObjCalled("steps").value = oldStep.concat(selectedTemplate);
}

/***********************************
* On Button Press (PC info)
************************************/

function CleanBomgar() {
  let fullStats = "";
  let PCname = "";
  let PCname_start = "Computer Name:       ";
  let PCname_end = "Operating System:    ";
  let lastReboot = "";
  let lastReboot_start = "Uptime:              ";
  let lastReboot_end = "Required Skills:     ";
  let oldStep = "";
  
  fullStats = ValueCalled("PCinfo");
  oldStep   = ValueCalled("steps");
  
  PCname = StringBetween(fullStats, PCname_start, PCname_end, -1);
  lastReboot = StringBetween(fullStats, lastReboot_start, lastReboot_end, -1);
  
  if(PCname !== "")
  {
    ObjCalled("PCinfo").value = PCname;
    ObjCalled("steps").value = oldStep.concat("\nLast Reboot = " + lastReboot);
  }
}

function PCUnableToObtain() {
  ObjCalled("PCinfo").value = ValueCalled("PCinfo").concat("(unable to obtain)");
}

/***********************************
* On Button Press (print-out area)
************************************/

function CompressCall() {
  let userID = "";
  let ticketID = "";
  let AppID = "";
  let KBID = "";
  let TicketType = "";
  let callNotes = "";
  let steps = "";
  let PCname = "";
  let RemoteOrNot = "";
  let facility = "";
  let LocationDetails = "";
  
  let compNotes = "--error--";
  
  userID          = ValueCalled("UserID");
  ticketID        = ValueCalled("Ticket");
  AppID           = ValueCalled("App");
  KBID            = ValueCalled("KBID");
  TicketType      = ValueCalled("TicketType");
  callNotes       = ValueCalled("this_call");
  steps           = ValueCalled("steps");
  PCname          = ValueCalled("PCinfo");
  RemoteOrNot     = ValueCalled("RemoteOrNot");
  facility        = ValueCalled("facility");
  LocationDetails = ValueCalled("LocationDetails");
  
  
  compNotes = printByLine([
    "Issue Description (Including Error Message) = ",
    AppID + " " + TicketType + callNotes,
    "",
    "ESD Troubleshooting =",
    steps,
    "",
    "PC Name = " + PCname,
    "Username = " + userID,
    "KB ID = " + KBID,
    "",
    "Location = " + RemoteOrNot + " / " + facility + " / " + LocationDetails,
    "",
    "<MID_DOC>",
    "> " + ticketID
  ]);
  

  ObjCalled("ProcText").value = compNotes;  
}

function FollowupCall() {
  let userID = "";
  let ticketID = "";
  let FullName = "";
  let phone = "";
  
  let compNotes = "--error--";
  
  userID     = ValueCalled("UserID");
  ticketID   = ValueCalled("Ticket");
  FullName   = ValueCalled("FullName");
  phone      = ValueCalled("phone");
  
  if (FullName == "") FullName = "___";
  
  compNotes = printByLine([
    "Caller = " + FullName + " (" + userID + ")",
    "Callback = " + phone,
    "For = " + ticketID
  ]);

  ObjCalled("ProcText").value = compNotes;
}

function EpicCall() {
  let userID = "";
  let ticketID = "";
  let AppID = "";
  let KBID = "";
  let TicketType = "";
  let callNotes = "";
  let steps = "";
  let PCname = "";
  let RemoteOrNot = "";
  let facility = "";
  let LocationDetails = "";
  let macro_02_a01 = "";
  let macro_02_a02 = "";
  let macro_02_a03 = "";
  let macro_02_a04 = "";
  let macro_02_a05 = "";
  let macro_02_a06 = "";
  let macro_02_a07 = "";
  let macro_02_a08 = "";
  let macro_02_a09 = "";
  
  let compNotes = "";
  
  userID          = ValueCalled("UserID");
  ticketID        = ValueCalled("Ticket");
  AppID           = ValueCalled("App");
  KBID            = ValueCalled("KBID");
  TicketType      = ValueCalled("TicketType");
  callNotes       = ValueCalled("this_call");
  steps           = ValueCalled("steps");
  PCname          = ValueCalled("PCinfo");
  RemoteOrNot     = ValueCalled("RemoteOrNot");
  facility        = ValueCalled("facility");
  LocationDetails = ValueCalled("LocationDetails");
  macro_02_a01    = ValueCalled("macro_02_a01");
  macro_02_a02    = ValueCalled("macro_02_a02");
  macro_02_a03    = ValueCalled("macro_02_a03");
  macro_02_a04    = ValueCalled("macro_02_a04");
  macro_02_a05    = ValueCalled("macro_02_a05");
  macro_02_a06    = ValueCalled("macro_02_a06");
  macro_02_a07    = ValueCalled("macro_02_a07");
  macro_02_a08    = ValueCalled("macro_02_a08");
  macro_02_a09    = ValueCalled("macro_02_a09");
  
  compNotes = compNotes.concat("Issue / Request Description = ")
    .concat("\n" + AppID)
    .concat(" " + TicketType)
    .concat(callNotes)
    .concat("\n\nIs this inpatient or outpatient? = " + macro_02_a01)
    .concat("\n\nDid the user have access before? (if applicable) = " + macro_02_a05)
    .concat("\nIs this occurring for several patients in Epic? = " + macro_02_a06)
    .concat("\nIs this issue affecting several co-workers? = " + macro_02_a07)
    .concat("\nHave you restarted user's VDI session? (If applicable) = " + macro_02_a08)
    .concat("\nScreenshot of error / issue attached? = " + macro_02_a09)
    .concat("\n\nUsername = " + userID)
    .concat("\nJob Title/Role = " + macro_02_a02)
    .concat("\nDepartment = " + macro_02_a03)
    .concat("\nEpic Template used = " + macro_02_a04)
    .concat("\n\nPC Name = " + PCname)
    .concat("\n\n*** Troubleshooting steps ***\n" + steps)
    .concat("\n\n\nSending to Tier 2 to look into further:")
    .concat("\n" + getEscSubjLine());

  ObjCalled("ProcText").value = compNotes;
}

/***********************************
* On Button Press (escalation)
************************************/

function makeEscSubjLine() {
  ObjCalled("ProcText").value =  getEscSubjLine();
}

/*******************************************
* On Button Press (macro for repeated calls)
********************************************/

function ApplyMacro01() {
  ObjCalled("this_call").value = ValueCalled("this_call").concat(ValueCalled("macro_01_this_call"));
  ObjCalled("steps").value = ValueCalled("steps").concat(ValueCalled("macro_01_steps"));
}


/*********************************
* METHODS - Form Data Manipulation
**********************************/
  
function logCall() {
  let logaddition = "";
  let currentlog = "";
  let newlog = "";
  
  CompressCall();
  
  logaddition = ValueCalled("ProcText");
  currentlog  = ValueCalled("call_log");
  
  newlog = newlog.concat(logaddition);
  newlog = newlog.concat("\n\n---\n\n");
  newlog = newlog.concat(currentlog);
  
  ObjCalled("call_log").value = newlog;
}

function getEscSubjLine() {
  let emailsubj = "";
  let emailsubjp1 = "";
  let emailsubjp2 = "___";
  let emailsubjp3 = "___";
  let emailsubjp4 = "";
  let esctype = "";
  let esctick = "";
  
  esctype = ValueCalled("Escalations");
  esctick = ValueCalled("Ticket");
  
  let esctypeTranslator = new Map([
    ["___","Escalation"],
    ["Standard","Escalation"],
    ["Epic","Epic"],
    ["PeopleSoft","PeopleSoft"],
    ["Possible Outage","Possible Outage"]
  ]);
  
  emailsubjp1 = esctypeTranslator.get(esctype);
  
  
  if (esctick !== "") emailsubjp2 = esctick;
  
  emailsubjp3 = ValueCalled("facility");
  if (emailsubjp3 == "") emailsubjp3 = "___";
  if (ValueCalled("RemoteOrNot") == "Remote") emailsubjp3 = "Remote / " + emailsubjp3;
  
  if (ObjCalled("APCEsc").checked) emailsubjp4 = " **Affecting Patient Care**";
  
  emailsubj = emailsubj.concat(emailsubjp1)
    .concat(" - Ticket# ")
    .concat(emailsubjp2)
    .concat(" (")
    .concat(emailsubjp3)
    .concat(")")
    .concat(emailsubjp4);
  return emailsubj;
}

function ClearFields(){
  ObjCalled("UserID").value = "";
  ObjCalled("Ticket").value = "";
  ObjCalled("FullName").value = "";
  ObjCalled("phone").value = "";
  Collapse ("macro_02_button", "macro_02_questions");
  Collapse ("more_notes_button", "more_notes");
  Collapse ("phonebutton", "phonearea");
  ObjCalled("App").value = "";
  ObjCalled("KBID").value = "";
  ObjCalled("TicketType").value = "___ > ";
  ObjCalled("temp_info").value = "";
  ObjCalled("next_ticket_notes").value = "";
  ObjCalled("this_call").value = "";
  ObjCalled("RemoteOrNot").value = "";
  ObjCalled("facility").value = "";
  ObjCalled("LocationDetails").value = "";
  ObjCalled("macro_02").value = "";
  ObjCalled("steps").value = "";
  ObjCalled("PCinfo").value = "";
  ObjCalled("ProcText").value = "";
  ObjCalled("Escalations").value = "___";
  ObjCalled("APCEsc").checked = false;
  ClearMacroQuestions();
}

function ClearMacroQuestions(){
  /*
  let id = "";
  for (i = 1; i <= 9; i++) {
    id = "macro_02_a0";
    id = id.concat("" + i);
    ObjCalled(id).value = "";
  }
  */
  
  clearDynamicForm("02");
}

function loadDynamicForm(formName){
  ObjCalled("macro_02_questions").innerHTML = dynamicForms.get(formName).toHTML();
}

function clearDynamicForm(formName){
  dynamicForms.get(formName).clearValues();
  loadDynamicForm(formName);
}


/*********************************
* METHODS - General Utility
**********************************/

function ObjCalled(inputID){
  return document.getElementById(inputID);
}

function ValueCalled(inputID){
  return ObjCalled(inputID).value;
}

function StringBetween(OriginalString, StartString, EndString, OffsetEnd){
  return OriginalString.slice((OriginalString.indexOf(StartString) + StartString.length), (OriginalString.indexOf(EndString) + OffsetEnd));
}

function Collapse (buttonlabel, arealabel) {
  if (ObjCalled(arealabel).style.display === "block") {
    ObjCalled(arealabel).style.display = "none";
    ObjCalled(buttonlabel).classList.toggle("active");
  }
}

function Uncollapse (buttonlabel, arealabel) {
  if (ObjCalled(arealabel).style.display != "block") {
    ObjCalled(arealabel).style.display = "block";
    ObjCalled(buttonlabel).classList.toggle("active");
  }
}

function holdInMap(arrayOfIDs) {
  let savedOnHold = new Map();
  
  arrayOfIDs.forEach((value, index, array) => {
    savedOnHold.set(value, ValueCalled(value));
  });
  
  return savedOnHold;
}

function loadHeldValues(savedOnHold){
  savedOnHold.forEach((value, key) => {
    ObjCalled(key).value = value;
  });
}

function printByLine(arrayOfStringsByLine){
  let printOut = "";
  
  arrayOfStringsByLine.forEach((value, index, array) => {
    printOut = printOut.concat("" + value + "\n");
  });
  
  return printOut;
}



/********************************
* SCRIPTING - CLASSES / STRUCTURE
*********************************/


let DynamicFormItemType = {
  Text : function() {
    return "type=\"text\"";
  },
  List : function(listName) {
    return "list=\"" + listName + "\" type=\"text\"";
  }
}

class DynamicFormItem{
  constructor(id, type, label, value) {
    this.id = id;
    this.type = type;
    this.label = label;
    
    if(value == undefined) this.value = "";
    else this.value = value;
  }
  
  toHTML() {
    let html_code = "";
    html_code = html_code
      .concat("<label for=\"" + this.id + "\" id=\"" + this.id + "_label\">" + this.label + "</label>")
      .concat("<input " + this.type + " id=\"" + this.id + "\" name=\"" + this.id + "\"><br>");
    return html_code;
  }
  
}

class DynamicForm{
  constructor(formName, arrayOfFormItemParams){
    this.formName = formName;
    
    if (arrayOfFormItemParams == undefined){
      this.dynamicFormItems = new Map();
    }
    else{
      let arrayOfFormItems = null;
      
      
      function createFormItem (value, index, array){
        let id = "macro_" + formName + "_a0" + (1 + index);
        
        return new DynamicFormItem(id, value[0], value[1]);
      }
      
      function prepFormItemForMap (value, index, array){
        return [value.id, value];
      }
      
      arrayOfFormItems = arrayOfFormItemParams.map(createFormItem);
      
      this.dynamicFormItems = new Map(arrayOfFormItems.map(prepFormItemForMap));
      
    }
  }
  
  toHTML(){
    let HTMLoutput = "";
    
    function compileHTML(value, key){
      HTMLoutput += value.toHTML();
    }
    
    this.dynamicFormItems.forEach(compileHTML);
    
    return HTMLoutput;
  }
  
  clearValues(){
    function clearValue(value, key){
      value.value = "";
    }
    
    this.dynamicFormItems.forEach(clearValue);
  }
}



/************************
* DATA
*************************/




/************************
* DATA - QUICK TEMPLATES
*************************/

let quickTemplates = new Map();
let tempQuickTemplate = "";

/************************
* QUICK TEMPLATES - Test
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("Some words of testing")
                            .concat("\n").concat("More words of testing");

quickTemplates.set("Test",tempQuickTemplate);

/************************
* QUICK TEMPLATES - Password Reset > Resolved
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("Reset password > logged-in successfully.");

quickTemplates.set("Password Reset > Resolved",tempQuickTemplate);

/************************
* QUICK TEMPLATES - Password Reset > Tier 2
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("Reset password > stuck on ___.creating/logging-in with new password.")
                        .concat("\n").concat("")
                        .concat("\n").concat("Sending to Tier 2 due to time limit:")
                        .concat("\n").concat("");

quickTemplates.set("Password Reset > Tier 2",tempQuickTemplate);

/************************
* QUICK TEMPLATES - Unlock
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("Unlocked > logged-in successfully");

quickTemplates.set("Unlock",tempQuickTemplate);

/************************
* QUICK TEMPLATES - Unblock
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("Unblocked > logged-in successfully");

quickTemplates.set("Unblock",tempQuickTemplate);

/************************
* QUICK TEMPLATES - Tier 2 (General)
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("")
                        .concat("\n").concat("Sending to Tier 2 due to time limit:")
                        .concat("\n").concat("");

quickTemplates.set("Tier 2 (General)",tempQuickTemplate);

/************************
* QUICK TEMPLATES - Possible Outage
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("")
                        .concat("\n").concat("Sending up as Possible Outage due to ___:")
                        .concat("\n").concat("");

quickTemplates.set("Possible Outage",tempQuickTemplate);

/************************
* QUICK TEMPLATES - Tier 3 (Epic)
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("")
                        .concat("\n").concat("Sending to Tier 3 to look into further:")
                        .concat("\n").concat("");

quickTemplates.set("Tier 3 (Epic)",tempQuickTemplate);

/************************
* QUICK TEMPLATES - Epic Inactive > Final Approver
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("Epic Account is Inactive.")
                        .concat("\n").concat("Advised to reach out to Epic Final Approver: https://applicationslearning.nychhc.org/Document/GetTrainingDoc?fn=Epic%20End%20User%20Access%20Request%20Process.pdf");

quickTemplates.set("Epic Inactive > Final Approver",tempQuickTemplate);

/************************
* QUICK TEMPLATES - Email ender
*************************/

tempQuickTemplate = "";
tempQuickTemplate = tempQuickTemplate.concat("")
                        .concat("").concat("If you have any other questions or concerns, please feel free to call us at 877 934 8442 and reference the ticket in this subject line.")
                        .concat("\n")
                        .concat("\n").concat("Thank you!");

quickTemplates.set("Email ender",tempQuickTemplate);





/************************
* DATA - DYNAMIC FORMS
*************************/

let dynamicForms = new Map();

/************************
* DYNAMIC FORMS - Epic
*************************/


let dynamicFormForEpic = new DynamicForm("02", [
  [DynamicFormItemType.Text(), "Is this inpatient or outpatient? = "],
  [DynamicFormItemType.Text(), "Job Title/Role = "],
  [DynamicFormItemType.Text(), "Department = "],
  [DynamicFormItemType.List("epic_templates"), "Epic Template used = "],
  [DynamicFormItemType.Text(), "Did the user have access before? (if applicable) = "],
  [DynamicFormItemType.Text(), "Is this occurring for several patients in Epic? = "],
  [DynamicFormItemType.Text(), "Is this issue affecting several co-workers? = "],
  [DynamicFormItemType.Text(), "Have you restarted user's VDI session? (If applicable) = "],
  [DynamicFormItemType.Text(), "Screenshot of error / issue attached? = "]
]);

// ObjCalled("macro_02_questions").innerHTML = dynamicFormForEpic.toHTML();

dynamicForms.set(dynamicFormForEpic.formName, dynamicFormForEpic);
loadDynamicForm(dynamicFormForEpic.formName);


/************************
* DATA - LISTS
*************************/
</script>

<!--
/************************
* LIST: Epic Templates
*************************/
-->

<datalist id="epic_templates">
  <option value="Inpatient - ClinDoc [100017]">
  <option value="Ambulatory [100001]">
  <option value="---">
  <option value="Professional Billing [100026]">
  <option value="Hospital Billing [100015]">
  <option value="Inpatient - Orders [100018]">
  <option value="---">
  <option value="Anesthesia [100002]">
  <option value="ASAP [100003]">
  <option value="Cadence [100007]">
  <option value="Grand Central [100000]">
  <option value="HIM [100012]">
  <option value="OPTIME [100022]">
  <option value="Radiant [100027]">
  <option value="Research [100030]">
  <option value="Stork [100033]">
  <option value="Cupid [100009]">
  <option value="Willow [100037]">
  <option value="Willow Ambulatory [100038]">
</datalist>

<!--
/************************
* LIST: Dynamic Form Names
*************************/
-->

<datalist id="macros_02">
  <option value="Tier 2 (General)">
  <option value="Tier 3 (Epic)">
  <option value="Password Reset > Resolved">
  <option value="Password Reset > Tier 2">
  <option value="Unlock">
  <option value="Unblock">
  <option value="Epic Inactive > Final Approver">
  <option value="Possible Outage">
  <option value="Email ender">
</datalist>

<!--
/************************
* LIST: Facilities
*************************/
-->

<datalist id="facilities">
  <option value="BELLEVUE">
  <option value="CENTRAL OFFICE">
  <option value="COLER">
  <option value="CHS">
  <option value="CUMBERLAND">
  <option value="ELMHURST">
  <option value="GOUVERNEUR">
  <option value="HARLEM">
  <option value="HJC">
  <option value="JACOBI">
  <option value="KINGS">
  <option value="LINCOLN">
  <option value="MCKINNEY">
  <option value="METROPOLITAN">
  <option value="NCB">
  <option value="QUEENS">
  <option value="SEAVIEW">
  <option value="SOUTH BROOKLYN">
  <option value="WOODHULL">
</datalist>

</body>
</html>
